[%# JSON format autocomplete response %]
[%  IF (! ac_field.defined );
        THROW rdgc '"ac_field" must be defined';
    END;
    IF (! ac_method.defined );
        THROW rdgc '"ac_method" must be defined';
    END;
    IF (! pk.defined );
        SET pk = c.controller.primary_key;
    END;
    
    SET dataset = [];
    SET no_wrapper = 1;
    SET count = 0;
    FOR r = results;
        dataset.push({ $ac_field => r.$ac_method, pk => r.$pk });
        count = count + 1;
    END;
    resultset = {
        'ResultSet' => {
            'Count'  => count,
            'Result' => dataset
        }
    };
    resultset.as_json;
%]
